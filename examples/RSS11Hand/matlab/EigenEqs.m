% SAH2cuik


% PRINCIPAL COMPONENT ANALYSIS IN JOINT SPACE
Tw_h=eye(4);

X = textread('datos13.txt');
[q b] = size(X);
CUIK = zeros(q,36);

for i=1:q
    Q = X(i,:);
    SAH_fkine;
    % It depends on which are the variables that are used for the problem. It 
    %could be done with the full variables, but it is better to do it with the 
    %variables of the simplified problem. So, the variables to be used here 
    %depend on how the original problem is simplified. This is the case for the 
    %can.
    CUIK(i,:) = [ T22(1:3,1)' T23(1:3,1)' T24(1:3,2)' T24(2:3,3)' T32(1:3,1)' T33(1:3,1)' T34(1:3,2)' T34(2:3,3)' -T40(1:2,1)' T42(1:3,1)' T43(1:3,1)' T44(1:3,2)' T44(1:3,3)'];
end

[E,h,L] = princomp(CUIK);

% point on manifold 
% p0 = [ 0.391072 -0.000000 0.920360 0.617686 -0.000000 0.786425 0.801498 -0.000000 0.597997 -1.000000 -0.000000 0.423945 -0.032138 0.905118 0.554529 -0.029529 0.831641 0.672659 -0.026257 0.739487 -0.999370 -0.035485 -0.073729 0.997278 0.553837 -0.178791 0.813202 0.358228 -0.186713 0.914774 0.145193 -0.185554 0.971848 0.053453 0.982293 0.179562 ]';

p0 = [0.0317909693626 4.13336171001e-13 0.999494539388 0.489744192737 3.60556072954e-13 0.871866174177 0.642530662155 3.16883135705e-13 0.766259974285 -1 4.13545201811e-13 0.0117960532102 -0.0354825385146 0.999300676768 0.472210086174 -0.0312795385805 0.880930885474 0.627077982474 -0.0276412766086 0.778465904021 -0.999370208806 -0.0354850074144 -0.166023994756 0.98612171316 0.0207790079714 0.00349836522661 0.999777972486 0.0207790079718 0.00349836522669 0.999777972486 0.0207790079733 0.00349836522695 0.999777972486 -0.166023994756 0.98612171316 -4.38836611431e-14 1 8.83375303384e-13 -7.51300620081e-12 -8.83375303395e-13 1 -1.48543225795e-12 0.729228976575 2.82976474564e-13 0.684269756546 0.953727311202 0.962803923783 1.11740345402e-13 0.270201044319 0.82567528794 1 0.715398652844 -0.0247939606944 0.698276468902 0.953727311214 0.957207708799 -0.0102694250414 0.289219537932 0.825675287921 0.814690042983 1 0.980930876092 -0.682445554699 -0.114896909461 0.72184954462 0.707106781186 -0.682445554698 -0.114896909461 0.72184954462 0.707106781185 57.596 28.845 243.568 12.5477535049 3.88408745825e-11 244.071714996 10.666074993 36.8208977313 239.610512449 83.828632056 47.8029579419 194.778285709 7.45366027828 -19.2888617907 11.0705650633 23.1765950012 16.8236610609 -14.545859497 ]';
p0=p0(1:36);

% These are the name of the variables in the simplified system
syms  p22_u_x  p22_u_y  p22_u_z  p23_u_x  p23_u_y  p23_u_z p24_u_x  p24_u_y  p24_u_z  p24_v_y p24_v_z  p32_u_x  p32_u_y  p32_u_z p33_u_x  p33_u_y  p33_u_z p34_u_x p34_u_y  p34_u_z  p34_v_y  p34_v_z p40_v_x  p40_v_y  p42_u_x  p42_u_y  p42_u_z  p43_u_x  p43_u_y  p43_u_z  p44_u_x  p44_u_y  p44_u_z  p44_v_x p44_v_y  p44_v_z 
 
ndx=find(abs(E)<1e-15);
E(ndx)=0;

Cx = transpose([p22_u_x  p22_u_y  p22_u_z  p23_u_x  p23_u_y  p23_u_z p24_u_x  p24_u_y  p24_u_z  p24_v_y p24_v_z  p32_u_x  p32_u_y  p32_u_z p33_u_x  p33_u_y  p33_u_z p34_u_x p34_u_y  p34_u_z  p34_v_y  p34_v_z p40_v_x  p40_v_y  p42_u_x  p42_u_y  p42_u_z  p43_u_x  p43_u_y  p43_u_z  p44_u_x  p44_u_y  p44_u_z  p44_v_x p44_v_y  p44_v_z]);

% we can decide how many equations to add
digits(9)
vpa(E(:,36-6:36)'*Cx - transpose(E(:,36-6:36))*p0)




%clear  p22_u_x  p22_u_y  p22_u_z  p23_u_x  p23_u_y  p23_u_z p24_u_x  p24_u_y  p24_u_z  p24_v_y p24_v_z  p32_u_x  p32_u_y  p32_u_z p33_u_x  p33_u_y  p33_u_z p34_u_x p34_u_y  p34_u_z  p34_v_y  p34_v_z p40_v_x  p40_v_y  p42_u_x  p42_u_y  p42_u_z  p43_u_x  p43_u_y  p43_u_z  p44_u_x  p44_u_y  p44_u_z  p44_v_x p44_v_y  p44_v_z 


   
   

